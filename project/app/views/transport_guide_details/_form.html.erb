<div class="span-24 last">
  <fieldset>
    <legend>
			Productos
    </legend>
    
    <%= form_for(@transport_guide_detail) do |f| %>

      <% if @transport_guide_detail.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@transport_guide_detail.errors.count, "error") %> prohibited this transport_guide from being saved:</h2>
          <ul>
            <% @transport_guide_detail.errors.full_messages.each do |msg| %>
              <li>
                <%= msg %>
              </li>
            <% end %>
          </ul>
        </div>
      <% end %>
      <ul>
        <li>
          <input id="cant_campos" type="hidden" value="3" name="cant_campos"></input>
          <label>Tipo de Producto:</label>
          <%= f.number_field :product_type_id,id: 'product_type_id' %>
        </li>
        <li>
          <label>Cantidad:</label>
          <%= f.number_field :amount,id: 'amount' %>
        </li>
        <li>
          <label>Peso (kg):</label>
          <%= f.number_field :weight, id: 'weight'%>
        </li>
        <li>
          <input id="add_product" type="button" value="add"></input>

        </li>
        <li>
          <label>Id Guia de Tranporte:</label>
          <%= f.number_field :transport_guide_id%>
        </li>
        <li>
          <label>Lista de Productos</label>
          <table>
            <thead>
              <tr>
                <th>Product Type</th>
                <th>Amount</th>               
                <th>Peso</th>
              </tr>

            </thead>
            <tbody id="tbDetail">

            </tbody>

          </table>
          <%= f.submit :guardar%>
        </li>
      </ul>

    <%end%>
  </fieldset>


</div>
<script>
  $("#add_product").click(function(){
    agregarFila(document.getElementById('cant_campos'));
  });

  
  function agregarFila(obj){
    $("#cant_campos").val(parseInt($("#cant_campos").val()) + 1);
    var oId = $("#cant_campos").val();
    var product_type_id = $("#product_type_id").val();
    var amount = $("#amount").val();
    var weight = $("#weight").val();
    //var  transport_guide_id = $("#transport_guide_id").val();
    var transport_guide_id = 7;
   
    var strHtml1 = "<td>" + product_type_id + '<input type="hidden" id="hdnProduct_type_id_' + oId + '" name="lista[' + oId + '][product_type_id]" value="' + product_type_id + '"/></td>';
    var strHtml2 = "<td>" + amount + '<input type="hidden" id="hdnAmount_' + oId + '" name="lista[' + oId + '][amount]" value="' + amount + '"/></td>' ;
    var strHtml3 = "<td>" + weight + '<input type="hidden" id="hdnWeight_' + oId + '" name="lista[' + oId + '][weight]" value="' + weight + '"/></td>' ;
    var strHtml4 = '<input type="hidden" id="hdnTransport_guide_id_' + oId + '" name="lista[' + oId + '][transport_guide_id]" value="' + transport_guide_id + '"/>' ;
    
    var strHtml6 = '<td><img src="/assets/borrar2.gif" width="30" height="30" alt="Eliminar" onclick="if(confirm(\'Realmente desea eliminar este detalle?\')){eliminarFila(' + oId + ');}"/>';
    //strHtml6 += '<input type="hidden" id="hdnIdCampos_' + oId +'" name="hdnIdCampos[]" value="' + oId + '" /></td>';
    var strHtmlTr = "<tr id='rowDetail_" + oId + "'></tr>";
    var strHtmlFinal = strHtml1 + strHtml2 + strHtml3 + strHtml4 + strHtml6;
    //tambien se puede agregar todo el HTML de una sola vez.
    //var strHtmlTr = "<tr id='rowDetalle_" + oId + "'>" + strHtml1 + strHtml2 + strHtml3 + strHtml4 + strHtml5 + strHtml6 +"</tr>";
    $("#tbDetail").append(strHtmlTr);
    //si se agrega el HTML de una sola vez se debe comentar la linea siguiente.
    $("#rowDetail_" + oId).html(strHtmlFinal);
    return false;
  }
  function eliminarFila(oId){
    $("#rowDetail_" + oId).remove();
    return false;
  }
  function cancelar(){
    $("#tbDetail").html("");
    return false;
  }
  
</script>

